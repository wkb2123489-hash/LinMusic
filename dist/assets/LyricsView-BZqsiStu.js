import{d as pe,u as xe,a3 as he,r,v as W,J as A,b as ge,m as ye,x as we,a4 as be,j as _e,f as y,c as f,y as P,a as e,e as _,G as L,L as l,T as w,t as x,g as ke,F as Ce,i as Le,z as v,w as H,W as Ee,$ as ze,o as c,X as Te,a2 as Ve,_ as De}from"./index-DlHL5jtV.js";const Me={key:0,class:"fixed inset-0 z-50 bg-black overflow-hidden flex flex-col text-white"},Pe={class:"absolute inset-0 z-0 overflow-hidden pointer-events-none"},je={class:"relative z-10 flex flex-col h-full w-full max-w-[1600px] mx-auto p-4 sm:p-5 md:p-10"},Be={class:"flex items-center justify-between w-full h-14 sm:h-16 shrink-0 z-20 animate-slide-down"},Fe={class:"flex flex-col items-center gap-1"},Re={class:"text-base font-semibold text-white/90 max-w-[300px] truncate"},Se={class:"material-symbols-outlined",style:{"font-size":"22px"}},Ne={class:"flex-1 overflow-hidden min-h-0 py-2 md:py-4"},Ue={class:"flex h-full w-full flex-row items-stretch gap-6 md:gap-16 overflow-x-auto md:overflow-visible no-scrollbar snap-x snap-mandatory md:snap-none touch-pan-x"},$e={class:"w-full md:w-5/12 lg:w-4/12 flex items-center justify-center md:justify-end shrink-0 min-w-full md:min-w-0 max-h-[45vh] md:max-h-full animate-slide-up snap-start md:snap-none",style:{"animation-delay":"0.1s"}},Ie={class:"relative aspect-square w-full max-w-[380px] md:max-w-[450px] group"},Xe={class:"absolute inset-0 rounded-2xl shadow-[0_30px_60px_-15px_rgba(0,0,0,0.8)] overflow-hidden"},qe=["src","alt"],Oe={key:1,class:"w-full h-full bg-white/5 flex items-center justify-center"},Ge={class:"lyrics-mask h-full w-full overflow-y-auto no-scrollbar scroll-smooth py-20 sm:py-24 md:py-28 px-4 md:px-6"},Je={class:"flex flex-col gap-6 md:gap-8 items-start justify-start"},We=["onClick"],Ae={key:0,class:"text-white/25 text-xl text-center w-full py-20"},He={class:"relative w-full shrink-0 flex flex-col justify-center z-20 animate-slide-up py-2 md:py-0 md:h-28",style:{"animation-delay":"0.3s"}},Ke={class:"flex flex-col items-center gap-3 md:gap-4 w-full"},Qe={class:"flex items-center justify-between w-full md:hidden"},Ye={class:"flex items-center gap-5 md:gap-7"},Ze={class:"material-symbols-outlined",style:{"font-size":"20px"}},et={key:0,class:"absolute -bottom-0.5 left-1/2 -translate-x-1/2 w-1 h-1 bg-primary rounded-full"},tt={class:"w-full flex items-center gap-3 text-[11px] font-medium text-white/40 tabular-nums"},st={class:"hidden md:flex items-center gap-2 absolute left-6 md:left-10"},lt={class:"hidden md:flex items-center gap-2 absolute right-6 md:right-10"},ot={class:"flex items-center gap-2 w-28 group"},nt=pe({__name:"LyricsView",setup(at){const j=ye(),a=xe(),{currentSong:o,isPlaying:B,volume:h,playMode:p,lyrics:F,currentLyricIndex:k,progress:K,formattedCurrentTime:Q,formattedDuration:Y,duration:Z}=he(a),u=r(!1),R=r(.7),ee=r(null),E=r([]),S=r(!1),z=r(null),T=r(null),d=r(!1),b=r(!1),V=r(0),D=r(!0);let M=null;const te=r("#4a3728"),se=W(()=>d.value?V.value:K.value),le=(t,s)=>{t&&(E.value[s]=t)},N=W(()=>h.value===0?"volume_off":h.value<.3?"volume_mute":h.value<.7?"volume_down":"volume_up"),oe=async()=>{if(!o.value){u.value=!1;return}const t=await Ve([{id:o.value.id,platform:o.value.platform}]);u.value=!!t[`${o.value.platform}-${o.value.id}`]};A(o,()=>{oe()},{immediate:!0}),A(k,t=>{t>=0&&E.value[t]&&Te(()=>{var s;(s=E.value[t])==null||s.scrollIntoView({behavior:"smooth",block:"center"})})});const U=()=>{S.value=!!document.fullscreenElement};ge(()=>{o.value||j.replace("/"),document.addEventListener("fullscreenchange",U),document.addEventListener("mousemove",C),document.addEventListener("mouseup",g),document.addEventListener("touchmove",C,{passive:!1}),document.addEventListener("touchend",g,{passive:!1}),document.addEventListener("touchcancel",g,{passive:!1})}),we(()=>{document.removeEventListener("fullscreenchange",U),document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",g),document.removeEventListener("touchmove",C),document.removeEventListener("touchend",g),document.removeEventListener("touchcancel",g),M&&clearTimeout(M)});const ne=()=>{j.back()},ae=t=>{if(!D.value){t==null||t();return}D.value=!1,t&&(M=window.setTimeout(()=>{t()},420))};be((t,s,i)=>{ae(i)});const $=async()=>{o.value&&(u.value?await Ee(o.value.platform,o.value.id)&&(u.value=!1):await ze(o.value)&&(u.value=!0))},ie=()=>{a.togglePlay()},re=()=>{a.playPrev()},ue=()=>{a.playNext()},ce=()=>{p.value==="shuffle"?a.playMode="sequence":a.playMode="shuffle"},de=()=>{const t=["sequence","loop","single"],s=t.indexOf(p.value);a.playMode=t[(s+1)%t.length]},me=()=>{h.value>0?(R.value=h.value,a.setVolume(0)):a.setVolume(R.value)},fe=async()=>{try{document.fullscreenElement?await document.exitFullscreen():await document.documentElement.requestFullscreen()}catch(t){console.error("Fullscreen error:",t)}},I=t=>{if("touches"in t){const s=t.touches[0]||t.changedTouches[0];return s?s.clientX:null}return t.clientX},X=t=>{"preventDefault"in t&&t.preventDefault(),d.value=!0,q(t)},q=t=>{if(!z.value)return;const s=I(t);if(s===null)return;const i=z.value.getBoundingClientRect(),n=Math.max(0,Math.min(1,(s-i.left)/i.width));V.value=n*100},O=t=>{"preventDefault"in t&&t.preventDefault(),b.value=!0,T.value=t.currentTarget,G(t)},G=t=>{const s=T.value;if(!s)return;const i=I(t);if(i===null)return;const n=s.getBoundingClientRect(),m=Math.max(0,Math.min(1,(i-n.left)/n.width));a.setVolume(m)},C=t=>{const s=d.value||b.value;d.value&&q(t),b.value&&G(t),s&&"touches"in t&&t.preventDefault()},g=t=>{const s=d.value||b.value;if(d.value){const i=V.value/100*Z.value;a.seekTo(i)}d.value=!1,b.value=!1,T.value=null,s&&t&&"touches"in t&&t.preventDefault()},ve=t=>{a.seekTo(t)};return(t,s)=>(c(),_e(w,{name:"lyrics-page",appear:""},{default:y(()=>{var i;return[D.value?(c(),f("div",Me,[e("div",Pe,[_(w,{name:"bg-fade",mode:"out-in"},{default:y(()=>{var n,m;return[(c(),f("div",{key:((n=l(o))==null?void 0:n.coverUrl)||"default",class:"absolute inset-0 bg-cover bg-center blur-[100px] scale-150 opacity-60 transition-all duration-[1.5s]",style:L({backgroundImage:(m=l(o))!=null&&m.coverUrl?`url(${l(o).coverUrl})`:"none"})},null,4))]}),_:1}),s[0]||(s[0]=e("div",{class:"absolute inset-0 bg-gradient-to-b from-black/20 via-black/40 to-black/70"},null,-1)),s[1]||(s[1]=e("div",{class:"absolute inset-0 bg-[radial-gradient(ellipse_at_top,transparent_0%,rgba(0,0,0,0.3)_70%)]"},null,-1)),s[2]||(s[2]=e("div",{class:"absolute inset-0 bg-[radial-gradient(ellipse_at_bottom,rgba(0,0,0,0.5)_0%,transparent_60%)]"},null,-1)),s[3]||(s[3]=e("div",{class:"absolute inset-0 opacity-[0.03]",style:{"background-image":"url('data:image/svg+xml,%3Csvg viewBox=%220 0 256 256%22 xmlns=%22http://www.w3.org/2000/svg%22%3E%3Cfilter id=%22noise%22%3E%3CfeTurbulence type=%22fractalNoise%22 baseFrequency=%220.9%22 numOctaves=%224%22 stitchTiles=%22stitch%22/%3E%3C/filter%3E%3Crect width=%22100%25%22 height=%22100%25%22 filter=%22url(%23noise)%22/%3E%3C/svg%3E')"}},null,-1))]),e("div",je,[e("header",Be,[e("button",{class:"flex items-center justify-center size-10 rounded-full bg-white/10 hover:bg-white/20 backdrop-blur-md transition-all duration-300 text-white group hover:scale-105 active:scale-95 border border-white/5",onClick:ne},[...s[4]||(s[4]=[e("span",{class:"material-symbols-outlined group-hover:-translate-y-0.5 transition-transform duration-300",style:{"font-size":"24px"}},"keyboard_arrow_down",-1)])]),e("div",Fe,[s[5]||(s[5]=e("span",{class:"text-[10px] font-bold tracking-[0.2em] uppercase text-white/40"},"正在播放",-1)),e("span",Re,x(((i=l(o))==null?void 0:i.name)||"Not playing"),1)]),e("button",{class:"flex items-center justify-center size-10 rounded-full bg-transparent hover:bg-white/10 transition-all duration-300 text-white/70 hover:text-white hover:scale-105 active:scale-95",title:"全屏",onClick:fe},[e("span",Se,x(S.value?"fullscreen_exit":"fullscreen"),1)])]),e("main",Ne,[e("div",Ue,[e("div",$e,[e("div",Ie,[e("div",{class:"absolute inset-0 rounded-2xl blur-3xl opacity-40 transition-opacity duration-1000",style:L({backgroundColor:te.value})},null,4),e("div",Xe,[_(w,{name:"cover-fade",mode:"out-in"},{default:y(()=>{var n;return[(n=l(o))!=null&&n.coverUrl?(c(),f("img",{key:l(o).coverUrl,src:l(o).coverUrl,alt:l(o).name,class:"w-full h-full object-cover"},null,8,qe)):(c(),f("div",Oe,[...s[6]||(s[6]=[e("span",{class:"material-symbols-outlined text-white/20 text-[100px]"},"music_note",-1)])]))]}),_:1})]),s[7]||(s[7]=e("div",{class:"absolute inset-0 rounded-2xl border border-white/10 pointer-events-none"},null,-1)),s[8]||(s[8]=e("div",{class:"absolute inset-0 rounded-2xl bg-gradient-to-br from-white/10 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-700 pointer-events-none"},null,-1)),s[9]||(s[9]=e("div",{class:"absolute bottom-3 left-1/2 -translate-x-1/2 rounded-full bg-black/40 px-3 py-1 text-[11px] text-white/70 flex items-center gap-1 md:hidden"},[e("span",{class:"material-symbols-outlined text-[14px]"},"swipe"),ke(" 左滑查看歌词 ")],-1))])]),e("div",{ref_key:"lyricsContainer",ref:ee,class:"w-full md:w-7/12 lg:w-6/12 h-full flex flex-col justify-center relative overflow-hidden animate-slide-up snap-start md:snap-none min-w-full md:min-w-0",style:{"animation-delay":"0.2s"}},[e("div",Ge,[e("div",Je,[(c(!0),f(Ce,null,Le(l(F),(n,m)=>(c(),f("p",{key:m,ref_for:!0,ref:J=>le(J,m),class:v(["lyric-line font-semibold cursor-pointer select-none leading-relaxed",[m===l(k)?"text-2xl sm:text-3xl md:text-4xl lg:text-[2.75rem] text-white py-2 active":m===l(k)-1||m===l(k)+1?"text-lg sm:text-xl md:text-2xl text-white/35 hover:text-white/55":"text-base sm:text-lg md:text-xl text-white/20 hover:text-white/40"]]),onClick:J=>ve(n.time)},x(n.text),11,We))),128)),l(F).length===0?(c(),f("div",Ae,[...s[10]||(s[10]=[e("span",{class:"material-symbols-outlined text-6xl mb-4 block opacity-40"},"lyrics",-1),e("p",{class:"font-medium"},"暂无歌词",-1)])])):P("",!0)])])],512)])]),e("footer",He,[e("div",Ke,[e("div",Qe,[e("button",{class:v(["btn-icon transition-all duration-300",u.value?"text-primary":"text-white/30 hover:text-primary"]),onClick:$},[e("span",{class:v(["material-symbols-outlined transition-all duration-300",[{"fill-1":u.value},u.value?"scale-110":"scale-100"]]),style:{"font-size":"24px"}},"favorite",2)],2),s[11]||(s[11]=e("div",{class:"flex items-center gap-2 text-white/40 text-xs"},[e("span",{class:"material-symbols-outlined",style:{"font-size":"18px"}},"volume_up"),e("span",null,"使用系统音量")],-1))]),e("div",Ye,[e("button",{class:v(["btn-icon p-2 rounded-full transition-all duration-300",l(p)==="shuffle"?"text-primary bg-primary/10":"text-white/40 hover:text-white hover:bg-white/5"]),onClick:ce},[...s[12]||(s[12]=[e("span",{class:"material-symbols-outlined",style:{"font-size":"20px"}},"shuffle",-1)])],2),e("button",{class:"btn-icon text-white/60 hover:text-white p-2 rounded-full hover:bg-white/5 transition-all duration-300",onClick:re},[...s[13]||(s[13]=[e("span",{class:"material-symbols-outlined fill-1",style:{"font-size":"30px"}},"skip_previous",-1)])]),e("button",{class:"btn-play size-14 md:size-16 group",onClick:ie},[_(w,{name:"play-icon",mode:"out-in"},{default:y(()=>[(c(),f("span",{key:l(B)?"pause":"play",class:"material-symbols-outlined fill-1",style:{"font-size":"32px"}},x(l(B)?"pause":"play_arrow"),1))]),_:1})]),e("button",{class:"btn-icon text-white/60 hover:text-white p-2 rounded-full hover:bg-white/5 transition-all duration-300",onClick:ue},[...s[14]||(s[14]=[e("span",{class:"material-symbols-outlined fill-1",style:{"font-size":"30px"}},"skip_next",-1)])]),e("button",{class:v(["btn-icon p-2 rounded-full relative transition-all duration-300",l(p)==="loop"||l(p)==="single"?"text-primary bg-primary/10":"text-white/40 hover:text-white hover:bg-white/5"]),onClick:de},[e("span",Ze,x(l(p)==="single"?"repeat_one":"repeat"),1),_(w,{name:"dot-fade"},{default:y(()=>[l(p)==="loop"||l(p)==="single"?(c(),f("div",et)):P("",!0)]),_:1})],2)]),e("div",tt,[e("span",{class:v(["w-9 text-right transition-colors duration-200",{"text-white/60":d.value}])},x(l(Q)),3),e("div",{ref_key:"progressBarRef",ref:z,class:v(["progress-bar relative group h-1.5 w-full",{"is-dragging":d.value}]),onMousedown:X,onTouchstart:H(X,["prevent"])},[e("div",{class:"progress-bar-fill h-full",style:L({width:`${se.value}%`})},[...s[15]||(s[15]=[e("div",{class:"progress-bar-thumb"},null,-1)])],4)],34),e("span",{class:v(["w-9 transition-colors duration-200",{"text-white/60":d.value}])},x(l(Y)),3)]),e("div",st,[e("button",{class:v(["btn-icon transition-all duration-300",u.value?"text-primary":"text-white/30 hover:text-primary"]),onClick:$},[e("span",{class:v(["material-symbols-outlined transition-all duration-300",[{"fill-1":u.value},u.value?"scale-110":"scale-100"]]),style:{"font-size":"26px"}},"favorite",2)],2)]),e("div",lt,[e("div",ot,[e("button",{class:"btn-icon text-white/40 hover:text-white transition-all duration-300",onClick:me},[_(w,{name:"volume-icon",mode:"out-in"},{default:y(()=>[(c(),f("span",{key:N.value,class:"material-symbols-outlined",style:{"font-size":"22px"}},x(N.value),1))]),_:1})]),e("div",{class:"volume-slider h-1 flex-1 cursor-pointer",onMousedown:O,onTouchstart:H(O,["prevent"])},[e("div",{class:"volume-slider-fill",style:L({width:`${l(h)*100}%`})},null,4)],32)])])])])])])):P("",!0)]}),_:1}))}}),rt=De(nt,[["__scopeId","data-v-0bc4831d"]]);export{rt as default};
