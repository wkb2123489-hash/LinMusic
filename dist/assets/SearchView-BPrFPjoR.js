import{d as j,u as q,r as u,v as B,b as L,x as I,c as l,a as s,e as C,t as n,f as O,y as S,F as m,i as h,z as P,T as D,A as F,B as K,C as A,D as G,w as H,E as R,G as J,H as W,s as v,I as x,p as X,n as Y,o as a,_ as Z}from"./index-DlHL5jtV.js";import{S as ee}from"./SongMenu-Dw8rpHEU.js";const te={class:"relative min-h-full"},se={class:"relative z-10 h-full flex flex-col"},oe={class:"px-4 sm:px-6 md:px-8 py-5 sm:py-6 border-b border-white/10"},le={class:"flex flex-col gap-4"},ae={class:"flex items-center gap-3 w-full max-w-[600px]"},ne={class:"relative shrink-0"},ie={key:0,class:"absolute left-0 top-full mt-2 bg-[#282828] rounded-lg shadow-2xl py-1 min-w-[140px] border border-white/10 z-50"},re=["onClick"],ce={class:"text-sm font-medium"},de={class:"relative flex-1"},ue={class:"relative flex items-center w-full h-12 rounded-full bg-white/10 hover:bg-white/15 focus-within:bg-white/15 transition-colors overflow-hidden"},me={class:"flex flex-wrap gap-2"},he=["onClick"],pe={class:"text-sm font-medium text-white/80"},fe={class:"flex-1 overflow-y-auto px-4 sm:px-6 md:px-8 py-5 sm:py-6"},ve={key:0,class:"flex flex-col gap-5 pb-32"},xe={class:"flex items-center justify-between"},we={class:"text-sm text-white/50"},ge={class:"flex flex-col"},_e=["onClick"],be={class:"w-8 text-center text-white/40 relative flex items-center justify-center"},ye={class:"rank-num font-medium"},ke={class:"flex items-center gap-4 min-w-0"},Ce=["src","alt"],Se={key:1,class:"w-10 h-10 rounded bg-white/10 flex items-center justify-center flex-shrink-0"},Pe={class:"flex flex-col min-w-0 flex-1"},Me={class:"text-white font-medium truncate"},ze={class:"text-sm text-white/50 truncate"},Te={class:"text-xs text-white/40 px-2 py-1 bg-white/5 rounded hidden sm:block"},Ve={class:"flex items-center gap-2"},$e=["onClick"],Qe={key:1,class:"flex flex-col gap-5 pb-32"},Ue={class:"flex flex-col gap-2"},Ee={key:2,class:"flex flex-col gap-5 pb-32"},Ne={class:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4"},je=["onClick"],qe={class:"absolute top-4 left-4 text-lg font-bold text-white z-10"},Be={class:"absolute bottom-2 right-2 text-white/20 transition-transform duration-300 group-hover:scale-110"},Le={class:"material-symbols-outlined",style:{"font-size":"48px",transform:"rotate(15deg)"}},Ie=j({name:"SearchView",__name:"SearchView",setup(Oe){const p=q(),r=u(""),c=u([]),w=u(!1),d=u(!1),i=u("all"),_=[{id:"all",name:"全部平台"},{id:"netease",name:"网易云"},{id:"qq",name:"QQ音乐"},{id:"kuwo",name:"酷我"}],M=B(()=>{const o=_.find(t=>t.id===i.value);return(o==null?void 0:o.name)||"全部平台"}),z=["周杰伦","林俊杰","邓紫棋","薛之谦","华语流行","英文歌曲"],T=[{name:"流行",color:"#8c67ac",icon:"music_note"},{name:"摇滚",color:"#e91429",icon:"graphic_eq"},{name:"嘻哈",color:"#ba5d07",icon:"mic_external_on"},{name:"电子",color:"#006450",icon:"bolt"},{name:"独立音乐",color:"#608108",icon:"nature_people"},{name:"放松",color:"#477d95",icon:"spa"},{name:"爵士",color:"#d8b021",icon:"piano"},{name:"古典",color:"#7d4b32",icon:"history_edu"},{name:"节奏布鲁斯",color:"#dc148c",icon:"favorite"},{name:"健身",color:"#148a08",icon:"fitness_center"}],b=async o=>{const[t,e]=await Promise.all([x(o,"netease",20,{timeoutMs:1e4}),x(o,"kuwo",20,{timeoutMs:1e4})]);return[...t,...e]},V=o=>G(o),$=o=>{i.value=o,d.value=!1,r.value.trim()&&g()},g=async()=>{const o=r.value.trim();if(o){w.value=!0;try{let t=[];if(i.value==="all"){try{t=await W(o,{timeoutMs:12e3,throwOnError:!0})}catch{t=[]}if(t.length===0){const e=await b(o);e.length>0&&(t=e,v.warning("全平台搜索暂不可用，已展示其他平台结果"))}}else if(i.value==="qq"){try{t=await x(o,i.value,30,{timeoutMs:1e4,throwOnError:!0})}catch{t=[]}if(t.length===0){const e=await b(o);e.length>0?(t=e,v.warning("QQ音乐搜索暂不可用，已展示其他平台结果")):v.warning("QQ音乐搜索暂不可用，请稍后重试")}}else t=await x(o,i.value,30,{timeoutMs:1e4});c.value=t.map(e=>({id:e.id,platform:e.platform,name:e.name,artist:e.artist,album:e.album,coverUrl:e.platform==="kuwo"?X(e.id,e.platform):Y(e.pic)}))}catch(t){console.error("Search failed:",t)}finally{w.value=!1}}},Q=()=>{r.value="",c.value=[]},y=o=>{r.value=o,g()},U=o=>{p.clearPlaylist(),p.addToPlaylist(c.value);const t=c.value.findIndex(e=>e.id===o.id&&e.platform===o.platform);p.playAt(t>=0?t:0)},E=o=>{p.addToPlaylist(o),v.success("已添加到播放列表")},k=o=>{o.target.closest(".relative")||(d.value=!1)};return L(()=>{document.addEventListener("click",k)}),I(()=>{document.removeEventListener("click",k)}),(o,t)=>(a(),l("div",te,[t[12]||(t[12]=s("div",{class:"absolute inset-0 bg-gradient-to-b from-[#1a1a2e] via-[#16213e] to-background-base pointer-events-none"},null,-1)),s("div",se,[s("div",oe,[s("div",le,[s("div",ae,[s("div",ne,[s("button",{class:"flex items-center gap-2 h-12 px-4 rounded-full bg-white/10 hover:bg-white/15 transition-colors text-white text-sm font-medium",onClick:t[0]||(t[0]=e=>d.value=!d.value)},[s("span",null,n(M.value),1),t[2]||(t[2]=s("span",{class:"material-symbols-outlined text-[18px]"},"expand_more",-1))]),C(D,{name:"menu-fade"},{default:O(()=>[d.value?(a(),l("div",ie,[(a(),l(m,null,h(_,e=>s("button",{key:e.id,class:P(["w-full px-4 py-2.5 flex items-center gap-2 text-left transition-colors",i.value===e.id?"text-primary bg-white/5":"text-white/80 hover:text-white hover:bg-white/10"]),onClick:f=>$(e.id)},[s("span",{class:P(["material-symbols-outlined text-[18px]",i.value===e.id?"opacity-100":"opacity-0"])},"check",2),s("span",ce,n(e.name),1)],10,re)),64))])):S("",!0)]),_:1})]),s("div",de,[s("div",ue,[t[4]||(t[4]=s("div",{class:"pl-4 pr-2 text-white/50"},[s("span",{class:"material-symbols-outlined text-[22px]"},"search")],-1)),F(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.value=e),type:"text",class:"w-full h-full bg-transparent border-none text-white placeholder-white/50 text-sm font-medium focus:outline-none focus:ring-0 pr-4",placeholder:"搜索歌曲、歌手、专辑...",onKeyup:A(g,["enter"])},null,544),[[K,r.value]]),r.value?(a(),l("button",{key:0,class:"pr-4 text-white/40 hover:text-white transition-colors",onClick:Q},[...t[3]||(t[3]=[s("span",{class:"material-symbols-outlined text-[20px]"},"close",-1)])])):S("",!0)])])]),s("div",me,[(a(),l(m,null,h(z,e=>s("button",{key:e,class:"h-8 px-4 rounded-full bg-white/10 hover:bg-white/20 transition-all duration-200 flex items-center justify-center",onClick:f=>y(e)},[s("span",pe,n(e),1)],8,he)),64))])])]),s("div",fe,[c.value.length>0?(a(),l("div",ve,[s("div",xe,[t[5]||(t[5]=s("h2",{class:"text-xl font-bold text-white tracking-tight"},"搜索结果",-1)),s("span",we,n(c.value.length)+" 首歌曲",1)]),s("div",ge,[(a(!0),l(m,null,h(c.value,(e,f)=>(a(),l("div",{key:`${e.platform}-${e.id}`,class:"song-row group grid grid-cols-[auto_1fr_auto] gap-4 px-4 py-3 items-center cursor-pointer",onClick:N=>U(e)},[s("div",be,[s("span",ye,n(f+1),1),t[6]||(t[6]=s("span",{class:"rank-play material-symbols-outlined text-white text-lg"},"play_arrow",-1))]),s("div",ke,[e.coverUrl?(a(),l("img",{key:0,src:e.coverUrl,alt:e.name,class:"w-10 h-10 rounded shadow-sm object-cover flex-shrink-0",loading:"lazy"},null,8,Ce)):(a(),l("div",Se,[...t[7]||(t[7]=[s("span",{class:"material-symbols-outlined text-white/30 text-lg"},"music_note",-1)])])),s("div",Pe,[s("span",Me,n(e.name),1),s("span",ze,n(e.artist),1)]),s("span",Te,n(V(e.platform)),1)]),s("div",Ve,[s("button",{class:"btn-icon text-white/30 hover:text-white opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-all duration-200",title:"添加到播放列表",onClick:H(N=>E(e),["stop"])},[...t[8]||(t[8]=[s("span",{class:"material-symbols-outlined text-[20px]"},"playlist_add",-1)])],8,$e),C(ee,{song:e,"button-class":"opacity-100 md:opacity-0 md:group-hover:opacity-100"},null,8,["song"])])],8,_e))),128))])])):w.value?(a(),l("div",Qe,[t[10]||(t[10]=s("h2",{class:"text-xl font-bold text-white tracking-tight"},"搜索中...",-1)),s("div",Ue,[(a(),l(m,null,h(8,e=>s("div",{key:e,class:"flex items-center gap-4 px-4 py-3"},[...t[9]||(t[9]=[R('<div class="w-8 h-4 bg-white/10 rounded skeleton" data-v-4020ddcb></div><div class="w-10 h-10 rounded bg-white/10 skeleton" data-v-4020ddcb></div><div class="flex flex-col gap-2 flex-1" data-v-4020ddcb><div class="h-4 bg-white/10 rounded w-1/2 skeleton" data-v-4020ddcb></div><div class="h-3 bg-white/10 rounded w-1/3 skeleton" data-v-4020ddcb></div></div>',3)])])),64))])])):(a(),l("div",Ee,[t[11]||(t[11]=s("h2",{class:"text-xl font-bold text-white tracking-tight"},"浏览分类",-1)),s("div",Ne,[(a(),l(m,null,h(T,e=>s("div",{key:e.name,class:"group relative aspect-[4/3] overflow-hidden rounded-lg transition-all duration-300 hover:scale-[1.02] hover:shadow-xl cursor-pointer",style:J({backgroundColor:e.color}),onClick:f=>y(e.name)},[s("span",qe,n(e.name),1),s("div",Be,[s("span",Le,n(e.icon),1)])],12,je)),64))])]))])])]))}}),Ke=Z(Ie,[["__scopeId","data-v-4020ddcb"]]);export{Ke as default};
