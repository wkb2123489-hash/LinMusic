import{d as U,c as i,a as e,w as b,t as w,o as n,u as F,r as x,b as N,e as S,f as L,g as V,h as B,F as k,i as $,j as D,k as Q,l as P,m as H,n as C,p as I,q as M,s as E}from"./index-B-8m7vOr.js";const R={class:"relative w-full aspect-square mb-4 rounded-md shadow-[0_8px_24px_rgba(0,0,0,0.5)] overflow-hidden"},G=["src","alt"],J={key:1,class:"w-full h-full bg-white/10 flex items-center justify-center skeleton"},K={class:"absolute top-2 right-2 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity duration-300 z-10"},O={class:"text-white font-bold truncate mb-1 group-hover:text-white/90 transition-colors"},W={class:"text-white/50 text-sm line-clamp-2"},X=U({__name:"PlaylistCard",props:{playlist:{}},emits:["click","play","add"],setup(r){return(p,l)=>(n(),i("div",{class:"bg-white/5 p-4 rounded-lg hover:bg-white/10 transition-all duration-300 group cursor-pointer",onClick:l[2]||(l[2]=c=>p.$emit("click",r.playlist))},[e("div",R,[r.playlist.coverUrl?(n(),i("img",{key:0,src:r.playlist.coverUrl,alt:r.playlist.name,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",loading:"lazy"},null,8,G)):(n(),i("div",J,[...l[3]||(l[3]=[e("span",{class:"material-symbols-outlined text-white/30 text-6xl"},"music_note",-1)])])),e("div",{class:"absolute bottom-2 right-2 translate-y-0 opacity-100 sm:translate-y-4 sm:opacity-0 sm:group-hover:translate-y-0 sm:group-hover:opacity-100 transition-all duration-300 z-20",onClick:l[0]||(l[0]=b(c=>p.$emit("play",r.playlist),["stop"]))},[...l[4]||(l[4]=[e("div",{class:"btn-play w-12 h-12"},[e("span",{class:"material-symbols-outlined text-[28px] fill-1 ml-0.5"},"play_arrow")],-1)])]),e("div",K,[e("button",{class:"w-8 h-8 rounded-full bg-black/60 flex items-center justify-center hover:bg-black/80 hover:scale-105 text-white transition-all duration-200",title:"添加到播放列表",onClick:l[1]||(l[1]=b(c=>p.$emit("add",r.playlist),["stop"]))},[...l[5]||(l[5]=[e("span",{class:"material-symbols-outlined text-[18px]"},"playlist_add",-1)])])])]),e("h3",O,w(r.playlist.name),1),e("p",W,w(r.playlist.description),1)]))}}),Y={class:"relative min-h-full"},Z={class:"relative z-10 px-4 sm:px-6 pb-6 sm:pb-8 pt-4 sm:pt-6 flex flex-col gap-8"},tt={class:"animate-fade-in"},st={class:"flex items-center justify-between mb-4"},ot={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6"},et={key:1,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6"},at=U({name:"HomeView",__name:"HomeView",setup(r){const p=H(),l=F(),c=x([]),g=(t,s)=>{const o=[t.pic,t.coverUrl,t.cover,t.image,t.img].find(u=>typeof u=="string"&&u.trim().length>0);return C(o)||C(I(t.id,s))},f=t=>t.artist?t.artist:t.singer?t.singer:t.singerName?t.singerName:t.author?t.author:Array.isArray(t.artists)&&t.artists.length>0?t.artists.map(s=>s.name||s).join(" / "):Array.isArray(t.ar)&&t.ar.length>0?t.ar.map(s=>s.name||s).join(" / "):"未知歌手",y=t=>{var s,a;return t.album||t.albumName||((s=t.al)==null?void 0:s.name)||((a=t.album)==null?void 0:a.name)},v=t=>M(t.duration??t.time??t.dt??t.length??t.songTime),m=x(!0),A=async()=>{m.value=!0;try{const t=["netease","qq"],s=[],a=await Promise.all(t.map(async o=>{try{const d=await Q(o);return{platform:o,toplists:d.slice(0,5)}}catch{return{platform:o,toplists:[]}}}));for(const{platform:o,toplists:d}of a)for(const u of d)s.push({id:u.id,name:u.name,description:`${q(o)} · ${u.updateFrequency||"实时更新"}`,platform:o,coverUrl:void 0});c.value=s.slice(0,10),_()}catch(t){console.error("Failed to load featured playlists:",t)}finally{m.value=!1}},q=t=>({netease:"网易云",kuwo:"酷我",qq:"QQ音乐"})[t],_=async()=>{for(const t of c.value)if(!t.coverUrl)try{const s=await P(t.id,t.platform);if(s.length>0){const a=s[0];t.coverUrl=g(a,t.platform),t.songs=s.map(o=>({id:o.id,platform:t.platform,name:o.name,artist:f(o),album:y(o),duration:v(o),coverUrl:g(o,t.platform)}))}}catch(s){console.error(`Failed to load cover for ${t.name}:`,s)}},h=async t=>{if(t.songs&&t.songs.length>0)return t.songs;try{const a=(await P(t.id,t.platform)).map(o=>({id:o.id,platform:t.platform,name:o.name,artist:f(o),album:y(o),duration:v(o),coverUrl:g(o,t.platform)}));return t.songs=a,a}catch(s){return console.error("Failed to load playlist songs:",s),[]}},z=t=>{p.push({name:"charts",query:{platform:t.platform,toplistId:t.id}})},T=async t=>{const s=await h(t);s.length>0&&(l.clearPlaylist(),l.addToPlaylist(s),l.playAt(0))},j=async t=>{const s=await h(t);s.length>0&&(l.addToPlaylist(s),E.success(`已添加 ${s.length} 首歌曲到播放列表`))};return N(()=>{A()}),(t,s)=>{const a=B("router-link");return n(),i("div",Y,[s[4]||(s[4]=e("div",{class:"absolute inset-0 bg-gradient-to-b from-[#1a1a2e] via-[#16213e] to-background-base pointer-events-none"},null,-1)),e("div",Z,[e("section",tt,[e("div",st,[s[1]||(s[1]=e("h2",{class:"text-2xl font-bold tracking-tight text-white hover:underline cursor-pointer"}," 精选歌单 ",-1)),S(a,{to:"/charts",class:"text-sm font-bold text-white/50 hover:text-white hover:underline cursor-pointer transition-colors"},{default:L(()=>[...s[0]||(s[0]=[V(" 查看全部 ",-1)])]),_:1})]),m.value?(n(),i("div",ot,[(n(),i(k,null,$(10,o=>e("div",{key:o,class:"bg-white/5 p-4 rounded-lg"},[...s[2]||(s[2]=[e("div",{class:"w-full aspect-square mb-4 rounded-md bg-white/10 skeleton"},null,-1),e("div",{class:"h-4 bg-white/10 rounded mb-2 w-3/4 skeleton"},null,-1),e("div",{class:"h-3 bg-white/10 rounded w-1/2 skeleton"},null,-1)])])),64))])):(n(),i("div",et,[(n(!0),i(k,null,$(c.value,o=>(n(),D(X,{key:`${o.platform}-${o.id}`,playlist:o,onClick:d=>z(o),onPlay:d=>T(o),onAdd:d=>j(o)},null,8,["playlist","onClick","onPlay","onAdd"]))),128))]))]),s[3]||(s[3]=e("div",{class:"h-32"},null,-1))])])}}});export{at as default};
