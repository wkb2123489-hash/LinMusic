import{d as O,u as Q,r as n,v as q,J as G,b as J,x as K,c as v,a as e,j as H,G as W,y as h,t as d,e as S,f as $,T as j,E as X,F as Y,i as Z,z as T,w as V,L as tt,M as et,A as E,B as M,N as st,s as p,O as lt,P as at,m as ot,Q as it,K as rt,o as u,R as nt,_ as dt}from"./index-B-8m7vOr.js";const ut={class:"relative"},ct={class:"relative px-4 sm:px-6 md:px-8 pt-12 sm:pt-16 pb-6 flex flex-col md:flex-row gap-4 sm:gap-6 items-start md:items-end z-10"},mt={class:"shrink-0 shadow-2xl shadow-black/50 group cursor-pointer relative"},vt={key:0,class:"w-full h-full flex items-center justify-center"},pt={class:"flex flex-col gap-2 w-full"},xt={class:"text-3xl sm:text-4xl md:text-6xl font-black text-white tracking-tight py-2"},ft={class:"text-gray-300 text-sm md:text-base font-medium mt-2"},bt={class:"relative px-4 sm:px-6 md:px-8 py-4 sm:py-6 z-30 flex items-center gap-4 sm:gap-6"},ht=["disabled"],yt={key:0,class:"absolute left-0 top-full mt-2 bg-[#282828] rounded-lg shadow-2xl py-1 min-w-[180px] border border-white/10 z-[100]"},wt={class:"relative z-10 px-4 sm:px-6 md:px-8 pb-32"},gt={class:"w-full"},_t={class:"flex flex-col mt-2"},kt=["onClick"],Ct={class:"w-8 text-center text-text-subdued relative flex items-center justify-center"},Pt={class:"flex flex-col justify-center min-w-0"},zt={class:"hidden md:block text-text-subdued text-sm truncate"},St={class:"hidden sm:block text-text-subdued text-sm truncate hover:text-white cursor-pointer hover:underline"},$t={class:"w-20 sm:w-28 md:w-32 text-right text-text-subdued text-sm"},jt={class:"flex items-center justify-end gap-2"},Tt=["onClick"],Vt=["onClick"],Et={class:"text-white/50 w-12 text-right tabular-nums"},Mt={key:0,class:"flex flex-col items-center justify-center py-20 text-text-subdued"},Nt={key:0,class:"fixed inset-0 z-[100] flex items-center justify-center p-4"},It={class:"relative bg-[#282828] rounded-lg p-6 w-full max-w-md shadow-2xl"},Ut={class:"flex flex-col gap-4"},Lt={class:"flex justify-end gap-3 mt-6"},Bt=["disabled"],Dt=O({name:"PlaylistView",__name:"PlaylistView",setup(Rt){const _=rt(),N=ot(),r=Q(),a=n(null),i=n([]),y=n(!1),x=n(!1),f=n(!1),c=n(""),b=n(""),w=n(null),g=q(()=>{var s,t;if(i.value.length===0)return(s=a.value)==null?void 0:s.coverUrl;for(let o=i.value.length-1;o>=0;o-=1){const m=i.value[o].coverUrl;if(m)return m}return(t=a.value)==null?void 0:t.coverUrl}),k=s=>{var t,o;return((t=r.currentSong)==null?void 0:t.id)===s.id&&((o=r.currentSong)==null?void 0:o.platform)===s.platform},I=async()=>{const s=parseInt(_.params.id);if(!isNaN(s)){y.value=!0;try{const t=await nt(s);t&&(a.value=t.playlist,i.value=t.songs)}catch(t){console.error("Failed to load playlist:",t)}finally{y.value=!1}}},U=(s,t)=>{const o=i.value.findIndex(l=>l.id===s.id&&l.platform===s.platform),m=o>=0?o:t;r.clearPlaylist(),r.addToPlaylist(i.value),r.playAt(m)},L=()=>{i.value.length>0&&(r.clearPlaylist(),r.addToPlaylist(i.value),r.playAt(0))},B=s=>{r.addToPlaylist(s),p.success("已添加到播放列表")},D=()=>{a.value&&(c.value=a.value.name,b.value=a.value.description||""),x.value=!1,f.value=!0},R=async()=>{if(!a.value||!c.value.trim())return;await lt(a.value.id,{name:c.value.trim(),description:b.value.trim()||void 0})?(a.value.name=c.value.trim(),a.value.description=b.value.trim()||void 0,p.success("歌单已更新")):p.error("更新失败"),f.value=!1},A=async()=>{a.value&&(confirm(`确定要删除歌单"${a.value.name}"吗？此操作无法撤消。`)&&(await at(a.value.id)?(p.success("歌单已删除"),window.dispatchEvent(new CustomEvent("linmusic-playlists-changed")),N.push("/")):p.error("删除失败")),x.value=!1)},F=async s=>{if(!a.value)return;await it(a.value.id,s.id,s.platform,s.playlistSongId)?(i.value=i.value.filter(o=>!(o.id===s.id&&o.platform===s.platform)),p.success("已从歌单移除")):p.error("移除失败")},C=s=>{w.value&&!w.value.contains(s.target)&&(x.value=!1)};return G(()=>_.params.id,()=>{I()},{immediate:!0}),J(()=>{document.addEventListener("click",C)}),K(()=>{document.removeEventListener("click",C)}),(s,t)=>{var o,m;return u(),v("div",ut,[t[19]||(t[19]=e("div",{class:"absolute top-0 left-0 w-full h-[400px] bg-gradient-to-b from-[#2e5c46] to-background-base pointer-events-none opacity-60"},null,-1)),e("header",ct,[e("div",mt,[e("div",{class:"size-32 sm:size-48 md:size-60 bg-surface-highlight rounded-lg bg-cover bg-center shadow-lg transition-all duration-300 group-hover:scale-[1.02]",style:W({backgroundImage:g.value?`url(${g.value})`:"none"})},[g.value?h("",!0):(u(),v("div",vt,[...t[5]||(t[5]=[e("span",{class:"material-symbols-outlined text-text-subdued text-6xl"},"music_note",-1)])]))],4)]),e("div",pt,[t[6]||(t[6]=e("span",{class:"text-xs font-bold uppercase tracking-wide text-white/90"},"歌单",-1)),e("h1",xt,d(((o=a.value)==null?void 0:o.name)||"加载中..."),1),e("p",ft,d(((m=a.value)==null?void 0:m.description)||"")+" - LinMusic - "+d(i.value.length)+"首歌曲 ",1)])]),e("div",bt,[e("button",{class:"size-12 sm:size-14 bg-primary hover:scale-105 hover:bg-primary/90 transition-all rounded-full flex items-center justify-center text-black shadow-lg shadow-primary/20",disabled:i.value.length===0,onClick:L},[...t[7]||(t[7]=[e("span",{class:"material-symbols-outlined text-4xl ml-1 fill-1"},"play_arrow",-1)])],8,ht),e("div",{class:"relative",ref_key:"menuRef",ref:w},[e("button",{class:"text-text-subdued hover:text-white transition-colors",onClick:t[0]||(t[0]=l=>x.value=!x.value)},[...t[8]||(t[8]=[e("span",{class:"material-symbols-outlined text-3xl"},"more_horiz",-1)])]),S(j,{name:"menu-fade"},{default:$(()=>[x.value?(u(),v("div",yt,[e("button",{class:"w-full px-4 py-3 flex items-center gap-3 text-left text-white/80 hover:text-white hover:bg-white/10 transition-colors",onClick:D},[...t[9]||(t[9]=[e("span",{class:"material-symbols-outlined text-[20px]"},"edit",-1),e("span",{class:"text-sm font-medium"},"编辑歌单",-1)])]),e("button",{class:"w-full px-4 py-3 flex items-center gap-3 text-left text-red-400 hover:text-red-300 hover:bg-white/10 transition-colors",onClick:A},[...t[10]||(t[10]=[e("span",{class:"material-symbols-outlined text-[20px]"},"delete",-1),e("span",{class:"text-sm font-medium"},"删除歌单",-1)])])])):h("",!0)]),_:1})],512)]),e("div",wt,[e("div",gt,[t[15]||(t[15]=X('<div class="grid grid-cols-[auto_4fr_auto] sm:grid-cols-[auto_4fr_3fr_auto] md:grid-cols-[auto_4fr_3fr_3fr_auto] gap-4 px-3 sm:px-4 py-2 border-b border-white/10 text-text-subdued text-sm font-medium uppercase tracking-wider md:sticky md:top-0 bg-background-base/95 backdrop-blur-sm z-20" data-v-86993d77><div class="w-8 text-center" data-v-86993d77>#</div><div data-v-86993d77>标题</div><div class="hidden md:block" data-v-86993d77>专辑</div><div class="hidden sm:block" data-v-86993d77>歌手</div><div class="w-20 sm:w-28 md:w-32 text-right" data-v-86993d77><span class="material-symbols-outlined text-lg" data-v-86993d77>schedule</span></div></div>',1)),e("div",_t,[(u(!0),v(Y,null,Z(i.value,(l,P)=>(u(),v("div",{key:`${l.platform}-${l.id}`,class:"group grid grid-cols-[auto_4fr_auto] sm:grid-cols-[auto_4fr_3fr_auto] md:grid-cols-[auto_4fr_3fr_3fr_auto] gap-4 px-3 sm:px-4 py-3 hover:bg-white/10 rounded-md items-center transition-colors cursor-pointer",onClick:z=>U(l,P)},[e("div",Ct,[e("span",{class:T(["group-hover:hidden font-medium",{"text-primary":k(l)}])},d(P+1),3),t[11]||(t[11]=e("span",{class:"material-symbols-outlined hidden group-hover:block text-white text-lg"},"play_arrow",-1))]),e("div",Pt,[e("span",{class:T(["font-medium text-base truncate",k(l)?"text-primary":"text-white"])},d(l.name),3)]),e("div",zt,d(l.album||"-"),1),e("div",St,d(l.artist),1),e("div",$t,[e("div",jt,[e("button",{class:"btn-icon text-white/30 hover:text-white opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-all duration-200",title:"添加到播放列表",onClick:V(z=>B(l),["stop"])},[...t[12]||(t[12]=[e("span",{class:"material-symbols-outlined text-[20px]"},"playlist_add",-1)])],8,Tt),e("button",{class:"btn-icon text-white/30 hover:text-red-400 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-all duration-200",title:"从歌单移除",onClick:V(z=>F(l),["stop"])},[...t[13]||(t[13]=[e("span",{class:"material-symbols-outlined text-[20px]"},"remove_circle_outline",-1)])],8,Vt),e("span",Et,d(tt(et)(l.duration)),1)])])],8,kt))),128))]),i.value.length===0&&!y.value?(u(),v("div",Mt,[...t[14]||(t[14]=[e("span",{class:"material-symbols-outlined text-6xl mb-4"},"queue_music",-1),e("p",{class:"text-lg"},"歌单为空",-1)])])):h("",!0)])]),(u(),H(st,{to:"body"},[S(j,{name:"modal"},{default:$(()=>[f.value?(u(),v("div",Nt,[e("div",{class:"absolute inset-0 bg-black/70",onClick:t[1]||(t[1]=l=>f.value=!1)}),e("div",It,[t[18]||(t[18]=e("h2",{class:"text-xl font-bold text-white mb-4"},"编辑歌单",-1)),e("div",Ut,[e("div",null,[t[16]||(t[16]=e("label",{class:"text-sm text-white/70 mb-1 block"},"歌单名称",-1)),E(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>c.value=l),type:"text",class:"w-full h-12 px-4 rounded-md bg-white/10 border border-white/20 text-white placeholder-white/50 focus:outline-none focus:border-white/40 transition-colors",placeholder:"歌单名称"},null,512),[[M,c.value]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"text-sm text-white/70 mb-1 block"},"歌单描述",-1)),E(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=l=>b.value=l),class:"w-full h-24 px-4 py-3 rounded-md bg-white/10 border border-white/20 text-white placeholder-white/50 focus:outline-none focus:border-white/40 transition-colors resize-none",placeholder:"添加描述（可选）"},null,512),[[M,b.value]])])]),e("div",Lt,[e("button",{class:"px-6 py-2 rounded-full text-white/70 hover:text-white font-medium transition-colors",onClick:t[4]||(t[4]=l=>f.value=!1)}," 取消 "),e("button",{class:"px-6 py-2 rounded-full bg-primary text-black font-bold hover:bg-[#1ed760] transition-colors",disabled:!c.value.trim(),onClick:R}," 保存 ",8,Bt)])])])):h("",!0)]),_:1})]))])}}}),Ft=dt(Dt,[["__scopeId","data-v-86993d77"]]);export{Ft as default};
